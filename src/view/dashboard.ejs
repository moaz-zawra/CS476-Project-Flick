<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flick | Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/js/color-scheme.js"></script>
    <script src="/js/categories.js"></script>
    <script src="/js/status-handler.js"></script>
    <script src="/js/dashboard.js"></script>
    <script>
        tailwind.config = window.tailwindConfig;
    </script>
</head>
<body class="p-4 bg-bg-light dark:bg-bg-dark min-h-screen">

<%- include('partials/header') %>
<%- include('partials/status-message') %>


<div class="flex justify-between items-center mt-4">
    <a href="/account">
    <div class="flex items-center">
      <div class="w-10 h-10 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center mr-4 font-mono text-xl text-accent-light dark:text-accent-dark font-bold hover:shadow-lg hover:bg-gray-200 dark:hover:bg-gray-500 transition-all duration-200">
        <%= user.username.charAt(0).toUpperCase() %>
      </div>
      <div class="font-mono text-2xl text-accent-light dark:text-accent-dark">
         <div><b><%= user.username %></b></div>
         
      </div>
    </div>
    </a>
    <a href="/public_sets" class="border-2 rounded-xl px-4 py-2 bg-main-button-light dark:bg-main-button-dark text-text-light dark:text-text-dark font-bold hover:bg-highlight-light dark:hover:bg-highlight-dark transition-all duration-200">
      View Public Sets
    </a>
  </div>
 
<br />

<% if (role === 'admin') { %>
    <%- include('partials/admin_dashboard') %>
<% } else if (role === 'moderator') { %>
    <%- include('partials/mod_dashboard') %>
<% } else if (role === 'regular') { %>
    <%- include('partials/regular_dashboard') %>
<% } %>

<div id="user-sets" class="space-y-4 mt-6"></div>
<div id="shared-sets" class="space-y-4 mt-6"></div>

<br />


<div id="report-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white dark:bg-gray-800 p-4 rounded-md w-2/3"> 
        <h2 class="text-lg font-bold mb-2">Report Set</h2>
        <textarea id="reason-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Enter reason for reporting"></textarea>
        <div class="flex justify-end mt-4">
            <button id="cancel-report" class="bg-gray-500 text-white px-4 py-2 rounded-md mr-2">Cancel</button>
            <button id="confirm-report" class="bg-red-500 text-white px-4 py-2 rounded-md">Report</button>
        </div>
    </div>
</div>

</body>
</html>


<script>
    
    window.categoryNames = <%- JSON.stringify(categoryNames) %>;
    window.subcategoriesData = <%- JSON.stringify(subcategories) %>;
</script>


<script src="/js/dashboard.js"></script>


<% if (typeof userSets !== 'undefined' && Array.isArray(userSets)) { %>
    <% userSets.forEach(function(set, index) { %>
        <script>
            const setData<%= index %> = <%- JSON.stringify(set) %>;
            insertSet(setData<%= index %>.setID, setData<%= index %>.setName, setData<%= index %>.description, setData<%= index %>.category, setData<%= index %>.subCategory, false, setData<%= index %>.publicSet, setData<%= index %>.approved);
        </script>
    <% }); %>
<% } else { %>
    <script>
        console.log("No sets available to display");
    </script>
<% } %>
<% if (typeof sharedSets !== 'undefined' && Array.isArray(sharedSets)) { %>
    <% sharedSets.forEach(function(set, index) { %>
        <script>
            const sharedSetData<%= index %> = <%- JSON.stringify(set) %>;
            insertSet(sharedSetData<%= index %>.setID, sharedSetData<%= index %>.setName, sharedSetData<%= index %>.description, sharedSetData<%= index %>.category, sharedSetData<%= index %>.subCategory, true, sharedSetData<%= index %>.publicSet, sharedSetData<%= index %>.approved);
        </script>
    <% }); %>
<% } else { %>
    <script>
        console.log("No shared sets available to display");
    </script>
<% } %>